(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[496],{1059:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(5155),d=a(2115),s=a(5695),n=a(7168),o=a(4161),i=a(3580),l=a(4616),c=a(2355),h=a(3052),m=a(9304),u=a(7741);let x="b979d98e-8011-7080-ec48-3e9d0ce6908f";function b(){let[e,t]=(0,d.useState)(!0),[a,b]=(0,d.useState)(()=>localStorage.getItem("viewMode")||"week"),[g,p]=(0,d.useState)(new Date),[f,v]=(0,d.useState)(!1),[k,w]=(0,d.useState)(null),[j,D]=(0,d.useState)(""),[S,N]=(0,d.useState)("#73a9e9"),y=(0,d.useRef)(null),[T,M]=(0,d.useState)([]),_=(0,s.useRouter)(),{toast:A}=(0,i.dj)(),C=e=>{b(e),localStorage.setItem("viewMode",e)},[E,I]=(0,d.useState)("");(0,d.useEffect)(()=>{(async()=>{if(!(0,u.wR)()){_.push("/");return}try{await (0,u.O3)()}catch(e){console.error("Failed to refresh tokens:",e),A({title:"Session expired",description:"Please log in again",variant:"destructive"}),(0,u.gf)(),_.push("/")}finally{t(!1)}})()},[_,A]),(0,d.useEffect)(()=>{(async()=>{try{var e,t,r,d,s;let n="",o=g.getFullYear(),i=g.getMonth()+1,l=g.getDate();if("day"===a){let e="".concat(o,"-").concat(String(i).padStart(2,"0"),"-").concat(String(l).padStart(2,"0"));n="https://sales.getatlasai.co/profile-service/api/v1/calendar/view-daily-calendar/?doctor_id=".concat(x,"&date=").concat(e)}else if("week"===a){let e=new Date(g);e.setDate(g.getDate()-g.getDay());let t=new Date(e);t.setDate(e.getDate()+6);let a="".concat(e.getFullYear(),"/").concat(String(e.getMonth()+1).padStart(2,"0"),"/").concat(String(e.getDate()).padStart(2,"0")),r="".concat(t.getFullYear(),"/").concat(String(t.getMonth()+1).padStart(2,"0"),"/").concat(String(t.getDate()).padStart(2,"0"));n="https://sales.getatlasai.co/profile-service/api/v1/calendar/view-weekly-calendar/?doctor_id=".concat(x,"&start_date=").concat(a,"&end_date=").concat(r)}else"month"===a?n="https://sales.getatlasai.co/profile-service/api/v1/calendar/view-monthly-calendar/?doctor_id=".concat(x,"&month=").concat(i,"&year=").concat(o):"list"===a&&(n="https://sales.getatlasai.co/profile-service/api/v1/appointment/view-appointments-list/".concat(x));let c=await fetch(n);if(!c.ok)throw Error("Failed to fetch appointments");let h=await c.json(),m=(h.appointments||(null===(e=h.data)||void 0===e?void 0:e.appointments)||(null===(r=h.data)||void 0===r?void 0:null===(t=r.weekly_calendar)||void 0===t?void 0:t.flatMap(e=>e.appointments.map(t=>({...t,date:e.date}))))||(null===(s=h.data)||void 0===s?void 0:null===(d=s.monthly_calendar)||void 0===d?void 0:d.flatMap(e=>e.appointments.map(t=>({...t,date:e.date}))))||[]).map((e,t)=>{var a,r;let[d,s]=e.appointment_time.split(":"),n=parseInt(d),c=parseInt(s),[m,u,x]=(e.date||(null===(a=h.data)||void 0===a?void 0:a.date)||"".concat(o,"-").concat(String(i).padStart(2,"0"),"-").concat(String(l).padStart(2,"0"))).split("-").map(Number),b=new Date(m,u-1,x,n,c);return{id:e.appointment_id||t,patient:e.patient_name,reason:(null===(r=e.reason_for_visit)||void 0===r?void 0:r.join(", "))||"General",date:b,hour:n,minute:c}});M(m)}catch(e){console.error("Error loading appointments:",e)}})()},[a,g]);let O=()=>{let e=[],t=new Date(g);t.setDate(g.getDate()-g.getDay());for(let a=0;a<7;a++){let r=new Date(t);r.setDate(t.getDate()+a),e.push(r)}return e},L=()=>{let e=[];for(let t=0;t<24;t++)for(let a of[0,30]){let r=t%12==0?12:t%12,d=0===a?"":":30",s=t<12?"AM":"PM";e.push({hour:t,minute:a,label:"".concat(r).concat(d," ").concat(s)})}return e},F=T.filter(e=>e.patient.toLowerCase().includes(E.toLowerCase()));if(e)return(0,r.jsx)(m.ThemeProvider,{children:(0,r.jsx)("main",{className:"min-h-screen bg-[#f5f5f7] dark:bg-[#1d1d1f] flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[#73a9e9]"}),(0,r.jsx)("p",{className:"mt-4 text-[#86868b] dark:text-[#a1a1a6]",children:"Loading scheduling..."})]})})});function $(e){let t=e=>e.toString().padStart(2,"0"),a=e.getFullYear(),r=t(e.getMonth()+1),d=t(e.getDate()),s=t(e.getHours()),n=t(e.getMinutes());return"".concat(a,"-").concat(r,"-").concat(d,"T").concat(s,":").concat(n)}return(0,r.jsx)(o.A,{activePage:"calendar",children:(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-medium mb-6 text-[#1d1d1f] dark:text-white",children:"Scheduling Calendar"}),(0,r.jsxs)(n.$,{onClick:()=>v(!0),className:"bg-[#73a9e9] hover:bg-[#5a9ae6] text-white rounded-lg h-9 px-4 text-sm font-medium",children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4"}),"New Appointment"]})]}),f&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-[#2c2c2e] p-6 rounded-lg shadow-xl w-[500px] max-w-full",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add New Event"}),(0,r.jsx)("input",{type:"text",placeholder:"Title",className:"w-full border border-gray-300 dark:border-[#3a3a3c] rounded px-3 py-2 mb-3"}),(0,r.jsx)("input",{type:"datetime-local",className:"w-full border border-gray-300 dark:border-[#3a3a3c] rounded px-3 py-2 mb-3",value:j,onChange:e=>D(e.target.value)}),(0,r.jsx)("input",{type:"datetime-local",className:"w-full border border-gray-300 dark:border-[#3a3a3c] rounded px-3 py-2 mb-3"}),(0,r.jsx)("textarea",{placeholder:"Description",className:"w-full border border-gray-300 dark:border-[#3a3a3c] rounded px-3 py-2 mb-3"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"text-sm text-[#86868b] dark:text-[#a1a1a6] block mb-2",children:"Color"}),(0,r.jsx)("input",{type:"color",ref:y,value:S,onChange:e=>N(e.target.value),className:"hidden"}),(0,r.jsx)("div",{onClick:()=>{var e;null===(e=y.current)||void 0===e||e.click()},className:"w-full h-10 rounded-md border border-[#e5e5ea] dark:border-[#3a3a3c] cursor-pointer",style:{backgroundColor:S}})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(n.$,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),(0,r.jsx)(n.$,{className:"bg-[#73a9e9] text-white",children:"+ Add"})]})]})}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(n.$,{variant:"outline",size:"sm",className:"bg-white dark:bg-[#2c2c2e] border border-[#e5e5ea] dark:border-[#3a3a3c] text-[#1d1d1f] dark:text-white hover:bg-[#f5f5f7] dark:hover:bg-[#3a3a3c] rounded-md h-9",onClick:()=>{let e=new Date(g);"week"===a?e.setDate(e.getDate()-7):"day"===a?e.setDate(e.getDate()-1):"month"===a&&e.setMonth(e.getMonth()-1),p(e)},children:(0,r.jsx)(c.A,{className:"h-4 w-4"})}),(0,r.jsx)(n.$,{variant:"outline",size:"sm",className:"bg-white dark:bg-[#2c2c2e] border border-[#e5e5ea] dark:border-[#3a3a3c] text-[#1d1d1f] dark:text-white hover:bg-[#f5f5f7] dark:hover:bg-[#3a3a3c] rounded-md h-9",onClick:()=>{let e=new Date(g);"week"===a?e.setDate(e.getDate()+7):"day"===a?e.setDate(e.getDate()+1):"month"===a&&e.setMonth(e.getMonth()+1),p(e)},children:(0,r.jsx)(h.A,{className:"h-4 w-4"})}),(0,r.jsx)(n.$,{variant:"outline",size:"sm",className:"bg-white dark:bg-[#2c2c2e] border border-[#e5e5ea] dark:border-[#3a3a3c] text-[#1d1d1f] dark:text-white hover:bg-[#f5f5f7] dark:hover:bg-[#3a3a3c] rounded-md h-9",onClick:()=>p(new Date),children:"Today"})]}),(0,r.jsx)("div",{className:"text-lg font-medium",children:(()=>{let e=new Date(g);e.setDate(g.getDate()-g.getDay());let t=new Date(e);if(t.setDate(e.getDate()+6),"week"===a){let a=e.toLocaleString("default",{month:"short"}),r=t.toLocaleString("default",{month:"short"}),d=e.getDate(),s=t.getDate(),n=t.getFullYear();return a===r?"".concat(a," ").concat(d," – ").concat(s,", ").concat(n):"".concat(a," ").concat(d," – ").concat(r," ").concat(s,", ").concat(n)}if("day"===a);else if("month"===a)return g.toLocaleDateString("en-US",{month:"long",year:"numeric"});return g.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})()}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(n.$,{variant:"month"===a?"default":"outline",size:"sm",className:"rounded-md h-9 ".concat("month"===a?"bg-[#73a9e9] hover:bg-[#5a9ae6] text-white":"bg-white dark:bg-[#2c2c2e] border border-[#e5e5ea] dark:border-[#3a3a3c] text-[#1d1d1f] dark:text-white hover:bg-[#f5f5f7] dark:hover:bg-[#3a3a3c]"),onClick:()=>C("month"),children:"Month"}),(0,r.jsx)(n.$,{variant:"week"===a?"default":"outline",size:"sm",className:"rounded-md h-9 ".concat("week"===a?"bg-[#73a9e9] hover:bg-[#5a9ae6] text-white":"bg-white dark:bg-[#2c2c2e] border border-[#e5e5ea] dark:border-[#3a3a3c] text-[#1d1d1f] dark:text-white hover:bg-[#f5f5f7] dark:hover:bg-[#3a3a3c]"),onClick:()=>C("week"),children:"Week"}),(0,r.jsx)(n.$,{variant:"day"===a?"default":"outline",size:"sm",className:"rounded-md h-9 ".concat("day"===a?"bg-[#73a9e9] hover:bg-[#5a9ae6] text-white":"bg-white dark:bg-[#2c2c2e] border border-[#e5e5ea] dark:border-[#3a3a3c] text-[#1d1d1f] dark:text-white hover:bg-[#f5f5f7] dark:hover:bg-[#3a3a3c]"),onClick:()=>C("day"),children:"Day"}),(0,r.jsx)(n.$,{variant:"list"===a?"default":"outline",size:"sm",className:"rounded-md h-9 ".concat("list"===a?"bg-[#73a9e9] hover:bg-[#5a9ae6] text-white":"bg-white dark:bg-[#2c2c2e] border border-[#e5e5ea] dark:border-[#3a3a3c] text-[#1d1d1f] dark:text-white hover:bg-[#f5f5f7] dark:hover:bg-[#3a3a3c]"),onClick:()=>C("list"),children:"List"})]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-[#2c2c2e] rounded-lg shadow-sm border border-[#e5e5ea] dark:border-[#3a3a3c] overflow-hidden",children:["month"===a&&(0,r.jsxs)("div",{className:"grid grid-cols-7 text-center",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,r.jsx)("div",{className:"p-2 text-sm font-medium border-b border-[#e5e5ea] dark:border-[#3a3a3c]",children:e},e)),(()=>{let e=g.getFullYear(),t=g.getMonth(),a=new Date(e,t,1),r=new Date(e,t+1,0),d=a.getDay(),s=r.getDate(),n=[];for(let e=0;e<d;e++)n.push(null);for(let a=1;a<=s;a++)n.push(new Date(e,t,a));for(;n.length%7!=0;)n.push(null);return n})().map((e,t)=>(0,r.jsxs)("div",{className:"h-32 p-2 border-b border-r relative text-right pr-2 cursor-pointer hover:bg-[#f0f4ff] dark:hover:bg-[#2e2e30] \n                      ".concat((null==e?void 0:e.toDateString())===new Date().toDateString()?"bg-[#73a9e9]/10 dark:bg-[#73a9e9]/10 text-[#73a9e9] font-semibold":""),onClick:()=>{e&&(w(e),D($(e)),v(!0))},children:[(0,r.jsx)("span",{className:"".concat((null==e?void 0:e.getMonth())!==g.getMonth()?"text-gray-400":""),children:null==e?void 0:e.getDate()}),e&&T.filter(t=>t.date.toDateString()===e.toDateString()).map(e=>(0,r.jsx)("div",{className:"bg-[#73a9e9] text-white text-xs mt-1 px-1 py-0.5 rounded text-left truncate",children:e.patient},e.id))]},t))]}),"week"===a&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"grid grid-cols-8 border-b border-[#e5e5ea] dark:border-[#3a3a3c]",children:[(0,r.jsx)("div",{className:"p-2 text-sm font-medium text-[#86868b] dark:text-[#a1a1a6] border-r",children:"Time"}),O().map((e,t)=>{let a=e.toDateString()===new Date().toDateString();return(0,r.jsx)("div",{className:"p-2 text-sm text-center border-r ".concat(a?"bg-[#e6f0fb] text-[#73a9e9] font-semibold":""),children:e.toLocaleDateString("en-US",{weekday:"short",month:"numeric",day:"numeric"})},t)})]}),L().map((e,t)=>(0,r.jsxs)("div",{className:"grid grid-cols-8 border-b border-[#e5e5ea] dark:border-[#3a3a3c]",children:[(0,r.jsx)("div",{className:"p-2 text-xs text-[#86868b] dark:text-[#a1a1a6] border-r border-[#e5e5ea] dark:border-[#3a3a3c]",children:e.label}),O().map((a,d)=>{let s=a.toDateString()===new Date().toDateString(),n=T.find(t=>t.date.toDateString()===a.toDateString()&&t.hour===e.hour&&t.minute===e.minute);return(0,r.jsx)("div",{className:"border-r h-12 relative cursor-pointer hover:bg-[#f0f4ff] dark:hover:bg-[#2e2e30]\n                            ".concat(s?"bg-[#e6f0fb]":""),onClick:()=>{let e=new Date(a);e.setHours(t,0,0,0),w(e),D($(e)),v(!0)},children:n&&(0,r.jsxs)("div",{className:"absolute inset-1 bg-[#73a9e9] text-white text-xs px-1 py-0.5 rounded",children:[n.patient," - ",n.reason]})},d)})]},t))]}),"day"===a&&(0,r.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"80px 1fr"},children:[(0,r.jsx)("div",{className:"col-span-2 bg-[#f5f5f7] dark:bg-[#2c2c2e] text-center text-sm font-medium py-2 border-b border-[#e5e5ea] dark:border-[#3a3a3c]",children:g.toLocaleDateString("en-US",{weekday:"long"})}),L().map((e,t)=>{let a=T.find(t=>t.date.toDateString()===g.toDateString()&&t.hour===e.hour&&t.minute===e.minute);return(0,r.jsxs)("div",{className:"contents",children:[(0,r.jsx)("div",{className:"p-2 text-xs text-[#86868b] dark:text-[#a1a1a6] border-r border-[#e5e5ea] dark:border-[#3a3a3c]",children:e.label}),(0,r.jsx)("div",{className:"border-b border-[#e5e5ea] dark:border-[#3a3a3c] h-10 cursor-pointer hover:bg-[#f0f4ff] dark:hover:bg-[#2e2e30]",onClick:()=>{let t=new Date(g);t.setHours(e.hour,e.minute,0,0),w(t),D($(t)),v(!0)},children:a&&(0,r.jsxs)("div",{className:"bg-[#73a9e9] text-white text-xs px-2 py-1 rounded-md",children:[a.patient," – ",a.reason]})})]},"day-slot-".concat(t))})]}),"list"===a&&(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by patient name",value:E,onChange:e=>I(e.target.value),className:"w-full mb-4 px-3 py-2 border rounded dark:bg-[#1d1d1f] dark:text-white dark:border-[#3a3a3c]"}),0===F.length?(0,r.jsx)("div",{className:"text-center text-[#86868b] dark:text-[#a1a1a6] text-sm",children:"No matching appointments"}):(0,r.jsx)("div",{className:"divide-y divide-[#e5e5ea] dark:divide-[#3a3a3c]",children:F.sort((e,t)=>e.date.getTime()-t.date.getTime()).map(e=>(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[#1d1d1f] dark:text-white",children:e.patient}),(0,r.jsx)("div",{className:"text-xs text-[#86868b] dark:text-[#a1a1a6]",children:e.date.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})}),(0,r.jsxs)("div",{className:"text-xs text-[#86868b] dark:text-[#a1a1a6] mt-1",children:["Reason: ",e.reason]})]},e.id))})]}),(0,r.jsx)("div",{className:"mt-8 py-12 border-t border-[#e5e5ea] dark:border-[#3a3a3c] text-center flex flex-col items-center",children:(0,r.jsxs)("p",{className:"text-xs text-[#86868b] dark:text-[#a1a1a6]",children:["\xa9 2025 Atlas AI • ",(0,r.jsx)("span",{className:"hover:underline cursor-pointer",children:"Help"})," •",(0,r.jsx)("span",{className:"hover:underline cursor-pointer",children:" Terms"})," •",(0,r.jsx)("span",{className:"hover:underline cursor-pointer",children:" Privacy"})," •",(0,r.jsx)("span",{className:"text-[#73a9e9]",children:" (v1.0.0)"})]})})]})]})})})}},3580:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m});var r=a(2115);let d=0,s=new Map,n=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],l={toasts:[]};function c(e){l=o(l,e),i.forEach(e=>{e(l)})}function h(e){let{...t}=e,a=(d=(d+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=r.useState(l);return r.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:h,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},4616:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7784:(e,t,a)=>{Promise.resolve().then(a.bind(a,1059))}},e=>{var t=t=>e(e.s=t);e.O(0,[421,129,675,397,161,441,684,358],()=>t(7784)),_N_E=e.O()}]);